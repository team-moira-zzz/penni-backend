<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.moira.pennibackend.domain.fixed.mapper.FixedExpenseMapper">
    <!-- ========================================================================================================== -->
    <!-- 고정 지출 등록 -->
    <insert id="insertAccountBookFixedExpense" parameterType="com.moira.pennibackend.global.entity.AccountBookFixedExpense">
        INSERT INTO "ACCOUNT_BOOK_FIXED_EXPENSE" (
               id
             , group_id
             , user_id
             , content
             , description
             , cycle
             , monthly_day
             , annual_month
             , annual_day
             , price
             , created_at
             , updated_at
        )
        VALUES (
               #{id}
             , #{groupId}
             , #{userId}
             , #{content}
             , #{description}
             , #{cycle}
             , #{monthlyDay}
             , #{annualMonth}
             , #{annualDay}
             , #{price}
             , #{createdAt}
             , #{updatedAt}
        )
    </insert>

    <!-- ========================================================================================================== -->
    <!-- 고정 지출 목록 조회 -->
    <select id="selectAccountBookFixedExpenseList" resultType="com.moira.pennibackend.domain.fixed.dto.response.FixedExpenseResponse">
        SELECT
               id
             , content
             , description
             , cycle
             , monthly_day  AS monthlyDay
             , annual_month AS annualMonth
             , annual_day   AS annualDay
             , price
             , created_at   AS createdAt
             , updated_at   AS updatedAt
        FROM "ACCOUNT_BOOK_FIXED_EXPENSE"
        WHERE group_id = #{groupId}
    </select>

    <!-- ========================================================================================================== -->
    <!-- 고정 지출 수정 -->
    <update id="updateAccountBookFixedExpense" parameterType="com.moira.pennibackend.domain.fixed.dto.request.FixedExpenseUpdateRequest">
        UPDATE "ACCOUNT_BOOK_FIXED_EXPENSE"
        SET
               content      = #{request.content}
             , description  = #{request.description}
             , cycle        = #{request.cycle}
             , monthly_day  = #{request.monthlyDay}
             , annual_month = #{request.annualMonth}
             , annual_day   = #{request.annualDay}
             , price        = #{request.price}
             , updated_at   = NOW()
        WHERE group_id = #{groupId} AND id = #{fixedId}
    </update>

    <!-- ========================================================================================================== -->
    <!-- 고정 지출 삭제 -->
    <delete id="deleteAccountBookFixedExpense">
        DELETE FROM "ACCOUNT_BOOK_FIXED_EXPENSE"
        WHERE group_id = #{groupId} AND id = #{fixedId}
    </delete>
</mapper>