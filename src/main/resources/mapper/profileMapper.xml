<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.moira.pennibackend.domain.profile.mapper.ProfileMapper">
    <!-- 내 프로필 조회 -->
    <select id="selectMyProfile" resultType="com.moira.pennibackend.domain.profile.dto.response.ProfileResponse">
        SELECT
               id
             , type
             , email
             , name
             , nickname
             , phone
             , last_login_at AS lastLoginAt
             , created_at AS createdAt
        FROM USER
    </select>

    <!-- 닉네임 중복 확인 -->
    <select id="checkNickname">
        SELECT count(id)
        FROM   USER
        WHERE  nickname = #{newNickname} AND id != #{userId}
    </select>

    <!-- 닉네임 변경 -->
    <update id="updateNickname">
        UPDATE USER
        SET    nickname = #{newNickname}
        WHERE  id = #{userId}
    </update>
</mapper>